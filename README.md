# LTE 드론 통신

LTE 네트워크를 기반으로 드론과 지상통제소(GCS) 간의 원활한 상호 작용을 가능하게 하는 통신 시스템입니다.

## 목차

- [개요](#개요)
- [주요 기능](#주요-기능)
- [프로젝트 구조](#프로젝트-구조)
- [시작하기](#시작하기)
  - [필수 조건](#필수-조건)
  - [설치 방법](#설치-방법)
  - [사용법](#사용법)
- [통신 아키텍처](#통신-아키텍처)
- [사용 기술](#사용-기술)
- [로드맵](#로드맵)
- [기여하기](#기여하기)
- [라이선스](#라이선스)
- [감사의 말](#감사의-말)

---

## 개요

**LTE 드론 통신**은 드론과 여러 지상통제소(GCS) 간의 LTE 네트워크를 통한 통신을 지원하도록 설계된 견고한 시스템입니다. MAVLink 프로토콜과 효율적인 네트워킹 기술을 활용하여 시야를 넘어선 드론의 신뢰할 수 있는 명령 및 제어를 보장합니다.

## 주요 기능

- **MAVLink 프로토콜 지원**: 표준화된 통신을 위한 MAVLink 프로토콜 구현.
- **마스터-슬레이브 GCS 아키텍처**:
  - **마스터 GCS**: 모드 변경, 미션 업로드 등 모든 제어 기능 제공.
  - **슬레이브 GCS**: 드론 상태 모니터링 기능만 제공하며 제어 권한 없음.
  - **동적 마스터 할당**: 현재 마스터 GCS가 연결 해제되면 슬레이브 GCS 중 하나를 자동으로 마스터로 승격.
- **효율적인 네트워킹**:
  - **논블로킹 I/O**: 확장성을 위한 논블로킹 소켓 사용.
  - **엣지 트리거 모드**: macOS의 `kqueue`와 Linux의 `epoll`을 사용한 이벤트 기반 아키텍처 구현.
- **크로스 플랫폼 디자인**:
  - **서버**: macOS에서 설계되었으며, Ubuntu와 Windows 지원 예정.
  - **클라이언트**: Ubuntu에서 실행되며, 드론의 비행 컨트롤러(FC)에 연결된 SBC에 적합.
- **이벤트 기반 단일 스레드 디자인**: 동시성 처리를 단순화하고 오버헤드 감소.

## 프로젝트 구조

```plaintext
LTE-Drone-Communication/
├── CMakeLists.txt        # 프로젝트 빌드 설정
├── server/               # 서버 코드
│   ├── CMakeLists.txt    # 서버 빌드 설정
│   └── server.cpp        # 서버 구현
├── client/               # 클라이언트 코드
│   ├── CMakeLists.txt    # 클라이언트 빌드 설정
│   └── client.cpp        # 클라이언트 구현
└── common/               # 공통 파일
    └── mavlink.h         # MAVLink 헤더 파일 (외부 라이브러리)
```

## 시작하기

### 필수 조건

- **C++ 컴파일러**: C++11 이상 호환.
- **CMake**: 버전 3.10 이상.
- **운영 체제**:
  - **서버**: macOS (향후 Ubuntu와 Windows 지원 예정).
  - **클라이언트**: Ubuntu (드론 FC에 연결된 SBC에서 테스트됨).
- **MAVLink 라이브러리**: `common/` 디렉토리에 포함.
- **LTE 라우터**: SBC가 고정 IP로 LTE에 연결하기 위해 필요.

### 설치 방법

#### 서버 설정 (macOS)

1. **리포지토리 클론**:

   ```bash
   git clone https://github.com/yourusername/LTE-Drone-Communication.git
   cd LTE-Drone-Communication
   ```

2. **서버 빌드**:

   ```bash
   mkdir build && cd build
   cmake ..
   make
   ```

3. **서버 실행**:

   ```bash
   ./server/server
   ```

#### 클라이언트 설정 (드론의 SBC에서 Ubuntu 사용)

1. **리포지토리 클론**:

   ```bash
   git clone https://github.com/yourusername/LTE-Drone-Communication.git
   cd LTE-Drone-Communication
   ```

2. **클라이언트 빌드**:

   ```bash
   mkdir build && cd build
   cmake ..
   make
   ```

3. **비행 컨트롤러에 연결**:

   - SBC가 드론의 FC에 시리얼 포트(예: `/dev/ttyAMA0`)로 연결되어 있는지 확인.

4. **클라이언트 실행**:

   ```bash
   ./client/client
   ```

   - 필요에 따라 `client.cpp`의 `serverIP`를 서버의 IP 주소로 수정.

### 사용법

#### 지상통제소 (GCS)

- **소프트웨어**: [QGroundControl](http://qgroundcontrol.com/) 또는 MAVLink 호환 GCS 사용.
- **연결 방법**:
  - 서버의 IP 주소와 포트 `54321`로 TCP 연결 설정.
  - 첫 번째로 연결된 GCS는 **마스터 GCS**로서 모든 제어 권한을 가짐.
  - 이후에 연결된 GCS는 **슬레이브 GCS**로서 모니터링 기능만 가짐.

## 통신 아키텍처

```plaintext
+-------------------+       TCP        +-------------------+       TCP        +-------------------+
|       GCS         |  <------------>  |      서버         |  <------------>  |      클라이언트    |
| (QGroundControl)  |                  |   (macOS/Linux)   |                  |  (Ubuntu SBC)     |
+-------------------+                  +-------------------+                  +-------------------+
                                                                    시리얼 포트로 FC에 연결
                                                                    (UART를 통한 MAVLink)
```

- **GCS ↔ 서버**: GCS 인스턴스는 TCP를 통해 서버에 연결됩니다. 서버는 GCS의 역할과 메시지 라우팅을 관리합니다.
- **서버 ↔ 클라이언트**: 서버는 드론 클라이언트와의 메시지를 중계합니다.
- **클라이언트 ↔ 드론 FC**: 클라이언트는 MAVLink 프로토콜을 사용하여 드론의 비행 컨트롤러와 시리얼 포트로 통신합니다.

## 사용 기술

- **프로그래밍 언어**: C++11
- **네트워킹**:
  - **소켓 프로그래밍**: 구성 요소 간의 TCP/IP 통신.
  - **논블로킹 소켓**: 블로킹 없는 효율적인 I/O.
  - **이벤트 기반 I/O**:
    - **서버**: 이벤트 알림을 위한 `kqueue`(macOS) 사용.
    - **클라이언트**: 확장 가능한 이벤트 처리를 위한 `epoll`(Linux) 사용.
- **MAVLink 프로토콜**: 드론과 GCS와의 통신을 위해 사용.
- **운영 체제**:
  - **macOS**: 서버 구현.
  - **Ubuntu**: SBC에서의 클라이언트 구현.
- **하드웨어**:
  - **싱글 보드 컴퓨터 (SBC)**: 드론의 비행 컨트롤러에 연결.
  - **LTE 라우터**: 고정 IP 주소로 네트워크 연결 제공.

## 로드맵

향후 개선 사항 및 계획된 기능:

1. **객체 지향 리팩토링**:
   - 절차적 프로그래밍에서 객체 지향 설계로 전환.
   - 기능을 클래스에 캡슐화하여 모듈화 개선.

2. **멀티스레딩 지원**:
   - 멀티스레드 처리를 구현하여 성능 향상.
   - 블로킹 없이 여러 클라이언트를 동시에 처리.

3. **크로스 플랫폼 호환성**:
   - 서버 코드를 Ubuntu와 Windows에서도 실행되도록 수정.
   - 조건부 컴파일을 사용하여 OS별 코드를 추상화.

4. **운영 체제 지원 강화**:
   - 다양한 운영 체제에서의 호환성을 보장하도록 내부 코드 수정.
   - macOS, Ubuntu, Windows 환경에서의 광범위한 테스트.

5. **보안 개선**:
   - 안전한 통신을 위한 암호화(TLS/SSL 등) 도입.
   - 클라이언트와 GCS의 인증 메커니즘 구현.

6. **로깅 및 모니터링**:
   - 문제 해결 및 성능 분석을 위한 상세 로깅 추가.
   - 실시간 모니터링 대시보드 구현.

7. **확장성 향상**:
   - 더 많은 수의 GCS와 드론을 위한 네트워크 처리 최적화.
   - 필요에 따라 로드 밸런싱 구현.

## 기여하기

기여는 언제나 환영합니다! 기여하려면:

1. **리포지토리 포크**: 프로젝트의 포크를 생성합니다.

2. **기능 브랜치 생성**:

   ```bash
   git checkout -b feature/YourFeature
   ```

3. **변경 사항 커밋**:

   ```bash
   git commit -am 'Add new feature'
   ```

4. **브랜치에 푸시**:

   ```bash
   git push origin feature/YourFeature
   ```

5. **풀 리퀘스트 열기**: 변경 사항을 검토하도록 제출합니다.

## 라이선스

이 프로젝트는 [MIT 라이선스](LICENSE)에 따라 라이선스가 부여됩니다. 라이선스 조건에 따라 이 소프트웨어를 자유롭게 사용, 수정 및 배포할 수 있습니다.

## 감사의 말

- **MAVLink 프로토콜**: [MAVLink 공식 문서](https://mavlink.io/kr/)
- **QGroundControl**: [QGroundControl 공식 웹사이트](http://qgroundcontrol.com/)
- **오픈 소스 라이브러리**: `common/` 디렉토리에 포함된 오픈 소스 라이브러리 사용.

---

**참고**: 이 프로젝트는 드론 통신 시스템의 기능과 범위를 향상시키려는 예비 개발자가 적극적으로 개발하고 있습니다. 피드백과 제안은 언제나 환영합니다!




